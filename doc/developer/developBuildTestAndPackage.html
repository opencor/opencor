<!DOCTYPE html>
<html>
    <head>
        <title>
            Develop, build, test and package
        </title>

        <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />

        <link href="res/stylesheet.css" rel="stylesheet" type="text/css" />

        <link href="../3rdparty/googleCodePrettify/prettify.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="../3rdparty/googleCodePrettify/prettify.js"></script>
    </head>
    <body onload="prettyPrint()">
        <h1>
            Develop, build, test and package
        </h1>

        <p>
            OpenCOR is being developed, built, tested and packaged on <a href="http://windows.microsoft.com/">Windows</a> 7, <a href="http://www.ubuntu.com/">Ubuntu</a> 11.04 (Natty Narwhal; both the 32-bit and 64-bit versions) and <a href="http://www.apple.com/macosx/">Mac OS X</a> 10.6 (Snow Leopard). The information which follows assumes that you are using one of these operating systems.
        </p>

        <h2>
            Pre-Requirements
        </h2>

        <p>
            The following tools are required in order to develop, build, test and/or package OpenCOR:
        </p>

        <ul>
            <li>
                <a href="http://git-scm.com/">Git</a> (the <a href="http://packages.ubuntu.com/natty/git">git</a> package on Ubuntu): a distributed version control system. You can get a copy of OpenCOR's source code by cloning our <A HREF ="https://github.com/opencor/opencor">Git repository</a> either in <em>read-only</em> mode:
                <pre class="prettyprint">$ git clone git://github.com/opencor/opencor.git</pre>
                or in <em>read-write</em> mode:
                <pre class="prettyprint">$ git clone git@github.com:opencor/opencor.git</pre>
                <div>
                    <strong>Note #1:</strong> you might want to check the GitHub help on setting up Git on <a href="http://help.github.com/win-set-up-git/">Windows</a>, <a href="http://help.github.com/linux-set-up-git/">Linux</a> and <a href="http://help.github.com/mac-set-up-git/">Mac OS X</a>, respectively.
                </div>
                <div>
                    <strong>Note #2:</strong> Git can be used either from the command line or with <a href="http://code.google.com/p/tortoisegit/">TortoiseGit</a>, <a href="http://sourceforge.net/projects/qgit/">QGit</a> or <a href="http://gitx.frim.nl/">GitX</a> on Windows, Linux and Mac OS X, respectively.
                </div>
            </li>
            <li><a href="http://www.cmake.org/">CMake</a> 2.8+ (the <a href="http://packages.ubuntu.com/natty/cmake">cmake</a> package on Ubuntu): a cross-platform build system;</li>
            <li>
                C++ toolchain: a set of C++ tools. The toolchain is different depending on the platform you are using:
                <ul>
                    <li>
                        Windows: MinGW 4.4.0;
                        <div>
                            <strong>Note:</strong> MinGW comes with Qt Creator (see below), but is needed to install Qt (see below), so either skip MinGW, install Qt Creator and then Qt, or unzip the contents of <code><a href="http://get.qt.nokia.com/misc/MinGW-gcc440_1.zip">MinGW-gcc440_1.zip</a></code> (e.g. in <code>C:\Qt\MinGW</code>) and refer to it when installing Qt.
                        </div>
                    </li>
                    <li>Linux: the <a href="http://packages.ubuntu.com/natty/g++">g++</a> package on Ubuntu; and</li>
                    <li>Mac OS X: <a href="http://developer.apple.com/xcode/">Xcode</a>.</li>
                </ul>
            </li>
            <li>
                <a href="http://qt.nokia.com/">Qt</a> 4.7.3: a cross-platform application and UI framework:
                <ul>
                    <li>
                        <a href="http://get.qt.nokia.com/qt/source/qt-win-opensource-4.7.3-mingw.exe">Windows</a>;
                        <div>
                            <strong>Note:</strong> you need to specify where MinGW is located and this will depend on the order in which you want to install MinGW, Qt and Qt Creator (see the MinGW section above).
                        </div>
                    </li>
                    <li>
                        <a href="http://get.qt.nokia.com/qt/source/qt-everywhere-opensource-src-4.7.3.tar.gz">Linux</a>; and
                        <div>
                            <strong>Note:</strong> Qt has to be built from its source code which requires some <a href="http://doc.qt.nokia.com/latest/requirements-x11.html">development packages</a> to be installed (<a href="http://packages.ubuntu.com/natty/libxrender-dev">libxrender-dev</a>, <a href="http://packages.ubuntu.com/natty/libxrandr-dev">libxrandr-dev</a>, <a href="http://packages.ubuntu.com/natty/libxcursor-dev">libxcursor-dev</a>, <a href="http://packages.ubuntu.com/natty/libxfixes-dev">libxfixes-dev</a>, <a href="http://packages.ubuntu.com/natty/libxinerama-dev">libxinerama-dev</a>, <a href="http://packages.ubuntu.com/natty/libfontconfig1-dev">libfontconfig1-dev</a>, <a href="http://packages.ubuntu.com/natty/libfreetype6-dev">libfreetype6-dev</a>, <a href="http://packages.ubuntu.com/natty/libxi-dev">libxi-dev</a>, <a href="http://packages.ubuntu.com/natty/libxt-dev">libxt-dev</a>, <a href="http://packages.ubuntu.com/natty/libxext-dev">libxext-dev</a>, <a href="http://packages.ubuntu.com/natty/libx11-dev">libx11-dev</a>, <a href="http://packages.ubuntu.com/natty/libsm-dev">libsm-dev</a>, <a href="http://packages.ubuntu.com/natty/libice-dev">libice-dev</a>, <a href="http://packages.ubuntu.com/natty/libglib2.0-dev">libglib2.0-dev</a> and <a href="http://packages.ubuntu.com/natty/libpthread-stubs0-dev">libpthread-stubs0-dev</a>). Though not mentioned on the list of required development packages, <a href="http://packages.ubuntu.com/natty/libdbus-1-dev">libdbus-1-dev</a> is also needed (to build the <a href="http://doc.qt.nokia.com/qtdbus.html">QtDBus</a> module). Once these development packages are installed, you can build the Qt library by entering the following on the command line:
                            <pre class="prettyprint">$ cd [Qt4.7.3]
$ ./configure
$ make
$ sudo make install
$ cd ..
$ rm -fr [Qt4.7.3]</pre>
                            Please be aware that <code>make</code> will take quite some time to complete, so be (very) patient.
                        </div>
                    </li>
                    <li><a href = "http://get.qt.nokia.com/qt/source/qt-mac-opensource-4.7.3.dmg">Mac OS X</a>.</li>
                </ul>
                <div>
                    <strong>Note:</strong> Qt and Qt Creator (see below) are part of Qt SDK 1.1, but sadly there are pending issues that make it impossible to build/package OpenCOR on Windows and Mac OS X. So, we would, at this stage, recommend installing Qt and Qt Creator individually so that the exact same Qt environment is used on all three platforms .
                </div>
            </li>
            <li>
                <a href="http://qt.nokia.com/products/developer-tools">Qt Creator</a> 2.2.1: a cross-platform environment for Qt:
                <ul>
                    <li>
                        <a href="http://get.qt.nokia.com/qtcreator/qt-creator-win-opensource-2.2.1.exe">Windows</a>;
                        <div>
                            <strong>Note:</strong> dependening on the order in which you want to install MinGW, Qt and Qt Creator (see the MinGW section above), you might want to select or unselect MinGW when installing Qt Creator.
                        </div>
                    </li>
                    <li>Linux <a href="http://get.qt.nokia.com/qtcreator/qt-creator-linux-x86-opensource-2.2.1.bin">32-bit</a>/<a href="http://get.qt.nokia.com/qtcreator/qt-creator-linux-x86_64-opensource-2.2.1.bin">64-bit</a>; and</li>
                    <li><a href = "http://get.qt.nokia.com/qtcreator/qt-creator-mac-opensource-2.2.1.dmg">Mac OS X</a>.</li>
                </ul>
            </li>
            <li><a href="http://nsis.sourceforge.net/">NSIS</a> (Windows only): a program for creating Windows installers.</li>
        </ul>

        <p>
            Note that though OpenCOR is currently being developed using Qt 4.7.3 and Qt Creator 2.2.1, it happens that it can also be built using Qt 4.6. For this reason, our various CMakeLists.txt files require Qt 4.6 or above, but this requirement will be revised as soon as Qt 4.6 is shown to break our build.
        </p>

        <p>
            Finally, you might want/need to update your <code>PATH</code> environment variable by adding the following paths:
        </p>

        <ul>
            <li>Windows: <code>C:\Program Files (x86)\CMake 2.8\bin</code>, <code>C:\Qt\MinGW\bin</code> and <code>C:\Qt\4.7.3\bin</code>; and</li>
            <li>Linux: <code>/usr/local/Trolltech/Qt-4.7.3/bin</code> (in <code>/etc/environment</code> on Ubuntu).</li>
        </ul>

        <h2>
            Develop
        </h2>

        <p class="warning">
            Except for the <a href="../user/authors.html" class="warning">authors</a>, OpenCOR is not currently opened for development, but this will change as soon as OpenCOR gets officially released.
        </p>

        <p>
            Different aspects related to the development of OpenCOR can be found in the following pages:
        </p>

        <ul>
            <li><a href="develop/plugins.html">Plugins</a></li>
            <li><a href="develop/internationalisation.html">Internationalisation</a></li>
        </ul>

        <h2>
            <a name="buildAndTest" class="sectionAnchor">Build and Test</a>
        </h2>

        <p>
            OpenCOR can be built in two different ways:
        </p>

        <ul>
            <li>
                <strong>Command line:</strong> various batch and VBScript files (<code>.bat</code> and <code>.vbs</code> files) on Windows and shell scripts on Linux / Mac OS X are available:
                <ul>
                    <li><a href="https://github.com/opencor/opencor/blob/master/cleanproj"><code>[OpenCOR]/cleanproj</code></a>[<a href="https://github.com/opencor/opencor/blob/master/cleanproj.bat"><code>.bat</code></a>]: cleans the OpenCOR environment;</li>
                    <li>
                        <a href="https://github.com/opencor/opencor/blob/master/makeproj"><code>[OpenCOR]/makeproj</code></a>[<a href="https://github.com/opencor/opencor/blob/master/makeproj.bat"><code>.bat</code></a>]: compiles and links everything that is required to get a release version of OpenCOR; and
                        <div>
                            <strong>Note:</strong> <code>makeproj[.bat]</code> does, by default, compile OpenCOR in parallel. You can, however, specify the number of jobs to be run simultaneously, thus making it possible to compile OpenCOR sequentially, if needed:
                            <pre class="prettyprint">$ ./makeproj 1</pre>
                        </div>
                    </li>
                    <li>
                        <a href="https://github.com/opencor/opencor/blob/master/runproj"><code>[OpenCOR]/runproj</code></a>[<a href="https://github.com/opencor/opencor/blob/master/runproj.bat"><code>.bat</code></a> | <a href="https://github.com/opencor/opencor/blob/master/runproj.vbs"><code>.vbs</code></a>]: runs OpenCOR.
                        <div>
                            <strong>Note:</strong> on Windows, if you were to run OpenCOR from a console window by just entering <code>runproj</code>, then the <code>runproj.bat</code> file would be executed (rather than the <code>runproj.vbs</code> file), offering you the opportunity to use OpenCOR as a console application. However, if you were to run OpenCOR by double clicking the <code>runproj.bat</code> file from within Windows Explorer, then a console window will quickly appear and disappear. To avoid this, you should double click on the <code>runproj.vbs</code> file.
                        </div>
                    </li>
                </ul>
            </li>
            <li>
                <strong>Using Qt Creator:</strong>
                <ul>
                    <li>Start Qt Creator;</li>
                    <li>Open <a href="https://github.com/opencor/opencor/blob/master/CMakeLists.txt"><code>[OpenCOR]/CMakeLists.txt</code></a> (by selecting the <code>File</code> | <code>Open File or Project...</code> menu or by pressing <code>Ctrl+O</code>);</li>
                    <li>Specify <a href="https://github.com/opencor/opencor/tree/master/build"><code>[OpenCOR]/build</code></a> as the build directory;</li>
                    <li>Select <code>MinGW Generator (MinGW (x86 32bit))</code> as the generator (Windows only), if necessary;</li>
                    <li>Click on the <code>Run CMake</code> button;</li>
                    <li>Click on the <code>Finish</code> button;</li>
                    <li>Select <code>OpenCOR</code> as the run target (by selecting the <code>Build</code> | <code>Open Build/Run Target Seclector...</code> menu or by pressing <code>Ctrl+T</code>), if necessary; and</li>
                    <li>
                        Build and test OpenCOR (by selecting the <code>Build</code> | <code>Run</code> menu or by pressing <code>Ctrl+R</code>).
                        <div>
                            <strong>Note #1:</strong> because of our use of CMake, debugging with Qt Creator requires an extra build step which can be set up by selecting the <code>Projects</code> view and by clicking on the <code>Add Build Step</code> drop-down button and clicking on the <code>Custom Process Step</code> menu item. From there, tick the <code>Enable custom process step</code> check box, set the <code>Command</code> field to <code>cmake</code>, the <code>Working directory</code> field to <a href="https://github.com/opencor/opencor/tree/master/build"><code>[OpenCOR]/build</code></a> and the <code>Command arguments</code> field to <code>-DCMAKE_BUILD_TYPE=Debug ..</code>. Finally, make sure that this new build step comes before the default <code>Make</code> build step.
                        </div>
                        <div>
                            <strong>Note #2:</strong> by default, Qt Creator will compile OpenCOR sequentially, but this can be changed by selecting the <code>Projects</code> view and by clicking on the <code>Details</code> drop-down button of the default <code>Make</code> build step under the <code>Build Steps</code> header. From there, just set the <code>Additional arguments</code> field to <code>-j [n]</code> where <code>n</code> is the number of jobs to be run simultaneously (if no <code>n</code> value is provided, then Qt Creator will try to run as many jobs as possible).
                        </div>
                    </li>
                </ul>
            </li>
        </ul>

        <h2>
            Package
        </h2>

        <p>
            Packaging of OpenCOR can only be done from the command line, using <a href="https://github.com/opencor/opencor/blob/master/packageproj.bat"><code>[OpenCOR]/packageproj.bat</code></a> on Windows and <a href="https://github.com/opencor/opencor/blob/master/packageproj"><code>[OpenCOR]/packageproj</code></a> on Linux / Mac OS X. Note that though the Linux package is originally meant for Ubuntu 11.04 (Natty Narwhal; both 32-bit and 64-bit), it should also work with other versions of Ubuntu, as well as other Linux distributions though additional libraries may be required in this particular case.
        </p>

        <div class="copyright">
            Copyright ©2011
        </div>
    </body>
</html>
