<!DOCTYPE html>
<html>
    <head>
        <title>
            Develop, build, test and package
        </title>

        <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />

        <link href="../res/stylesheet.css" rel="stylesheet" type="text/css" />
        <link href="../res/developerStylesheet.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>
            Develop, build, test and package
        </h1>

        <p>
            OpenCOR is developed, built, tested and packaged on <a href="http://www.microsoft.com/windows/windows-7/">Windows 7</a>, <a href="http://www.ubuntu.com/">Ubuntu</a> 10.10 (Maverick Meerkat; both the 32-bit and 64-bit versions) and <a href="http://www.apple.com/macosx/">Mac OS X</a> 10.6 (Snow Leopard). The information which follows assumes that you are using one of these operating systems.
        </p>

        <h2>
            Pre-Requirements
        </h2>

        <p>
            The following tools are required in order to develop, build, test and/or package OpenCOR:
        </p>

        <ul>
            <li>
                <a href="http://git-scm.com/">Git</a> (the <a href="http://packages.ubuntu.com/maverick/git">git</a> package on Ubuntu): a distributed version control system. You can get a copy of OpenCOR's source code by cloning our <A HREF ="http://opencor.git.sourceforge.net/git/gitweb.cgi?p=opencor/opencor;a=tree;hb=HEAD">Git repository</a> either in <em>read-only</em> mode:
                <pre>$ git clone git://opencor.git.sourceforge.net/gitroot/opencor/opencor</pre>
                or in <em>read-write</em> mode:
                <pre>$ git clone ssh://<strong>login</strong>@opencor.git.sourceforge.net/gitroot/opencor/opencor</pre>
            </li>
            <li><a href="http://www.cmake.org/">CMake</a> 2.8+ (the <a href="http://packages.ubuntu.com/maverick/cmake">cmake</a> package on Ubuntu): a cross-platform build system;</li>
            <li>
                C++ toolchain: a set of C++ tools. The toolchain is different depending on the platform you are using:
                <ul>
                    <li>
                        Windows: <a href="http://get.qt.nokia.com/misc/MinGW-gcc440_1.zip">MinGW</a> 4.4.0;
                        <div>
                            <strong>Note:</strong> MinGW also comes with Qt Creator (see below), but is needed to install Qt (see below), so either skip MinGW, install Qt Creator and then Qt, or unzip the contents of <a href="http://get.qt.nokia.com/misc/MinGW-gcc440_1.zip"><code>MinGW-gcc440_1.zip</code></a> somewhere (e.g. <code>C:\Qt\MinGW\</code>).
                        </div>
                    </li>
                    <li>Ubuntu: the <a href="http://packages.ubuntu.com/maverick/g++">g++</a> package; and</li>
                    <li>Mac OS X: <a href="http://developer.apple.com/technologies/tools/xcode.html">Xcode</a>.</li>
                </ul>
            </li>
            <li>
                <a href="http://qt.nokia.com/">Qt</a> 4.7.2: a cross-platform application and UI framework:
                <ul>
                    <li>
                        <a href="http://qt.nokia.com/downloads/windows-cpp">Windows</a>;
                        <div>
                            <strong>Note:</strong> you need to specify where MinGW is located and this will depend on the order in which you want to install MinGW, Qt and Qt Creator (see the MinGW section above).
                        </div>
                    </li>
                    <li>
                        <a href="http://qt.nokia.com/downloads/linux-x11-cpp">Linux</a>; and
                        <div>
                            <strong>Note:</strong> Qt has to be built from its source code which requires some <a href="http://doc.qt.nokia.com/latest/requirements-x11.html">development packages</a> to be installed (<a href="http://packages.ubuntu.com/maverick/libxrender-dev">libxrender-dev</a>, <a href="http://packages.ubuntu.com/maverick/libxrandr-dev">libxrandr-dev</a>, <a href="http://packages.ubuntu.com/maverick/libxcursor-dev">libxcursor-dev</a>, <a href="http://packages.ubuntu.com/maverick/libxfixes-dev">libxfixes-dev</a>, <a href="http://packages.ubuntu.com/maverick/libxinerama-dev">libxinerama-dev</a>, <a href="http://packages.ubuntu.com/maverick/libfontconfig1-dev">libfontconfig1-dev</a>, <a href="http://packages.ubuntu.com/maverick/libfreetype6-dev">libfreetype6-dev</a>, <a href="http://packages.ubuntu.com/maverick/libxi-dev">libxi-dev</a>, <a href="http://packages.ubuntu.com/maverick/libxt-dev">libxt-dev</a>, <a href="http://packages.ubuntu.com/maverick/libxext-dev">libxext-dev</a>, <a href="http://packages.ubuntu.com/maverick/libx11-dev">libx11-dev</a>, <a href="http://packages.ubuntu.com/maverick/libsm-dev">libsm-dev</a>, <a href="http://packages.ubuntu.com/maverick/libice-dev">libice-dev</a>, <a href="http://packages.ubuntu.com/maverick/libglib2.0-dev">libglib2.0-dev</a> and <a href="http://packages.ubuntu.com/maverick/libpthread-stubs0-dev">libpthread-stubs0-dev</a>). Though not mentioned on the list of required development packages, <a href="http://packages.ubuntu.com/maverick/libdbus-1-dev">libdbus-1-dev</a> is also needed (to build the <a href="http://doc.qt.nokia.com/qtdbus.html">QtDBus</a> module). Once these development packages are installed, you can build the Qt library by doing the following from the command line:
                            <pre>$ cd [Qt4.7.2]
$ ./configure
$ make
$ sudo make install
$ cd ..
$ rm -fr [Qt4.7.2]</pre>
                            Please be aware that <code>make</code> will take quite some time to complete, so be (very) patient.
                        </div>
                    </li>
                    <li><a href = "http://qt.nokia.com/downloads/qt-for-open-source-cpp-development-on-mac-os-x">Mac OS X</a>.</li>
                </ul>
                <div>
                    <strong>Note:</strong> Qt and Qt Creator (see below) can be installed as part of the Qt SDK, but we would still recommend installing Qt and Qt Creator individually (this is indeed the safest way to ensure that everything is going to work as expected).
                </div>
            </li>
            <li>
                <a href="http://qt.nokia.com/products/developer-tools">Qt Creator</a> 2.1.0: a cross-platform environment for Qt:
                <ul>
                    <li>
                        <a href="http://qt.nokia.com/downloads/qt-creator-binary-for-windows">Windows</a>;
                        <div>
                            <strong>Note:</strong> dependening on the order in which you want to install MinGW, Qt and Qt Creator (see the MinGW section above), you might want to select or unselect MinGW when installing Qt Creator.
                        </div>
                    </li>
                    <li>
                        Linux <a href="http://qt.nokia.com/downloads/qt-creator-binary-for-linux-x11-32-bit">32-bit</a>/<a href="http://qt.nokia.com/downloads/qt-creator-binary-for-linux-x11-64-bit">64-bit</a>; and
                        <div>
                            <strong>Note:</strong> once installed, you might want to check that Qt Creator does have access to Qt. To do so, select the <code>Tools|Options...</code> menu, then the <code>Qt4</code> section, and finally the <code>Qt Versions</code> tab. Under the <code>Auto-detected</code> section, there should be an entry called <code>Qt in PATH</code> and most likely it reads <code>&lt;Not found&gt;</code>. A generic solution is to <code>sudo</code> edit <code>/etc/environment</code> by adding the path to Qt to it:
                            <pre>PATH="<strong>/usr/local/Trolltech/Qt-4.7.2/bin:/opt/qtcreator-2.1.0/bin:</strong>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games"</pre>
                        </div>
                    </li>
                    <li><a href = "http://qt.nokia.com/downloads/qt-creator-binary-for-mac">Mac OS X</a>.</li>
                </ul>
                <div>
                    <strong>Note #1:</strong> both CMake and Git are supported by Qt Creator, but Git might need configuring. This can be done by selecting the <code>Tools|Options...</code> menu, then the <code>Version Control</code> section, and finally the <code>Git</code> tab. Alternatively, you might want to use Git from the command line, or with <a href="http://code.google.com/p/tortoisegit/">TortoiseGit</a>, <a href="http://sourceforge.net/projects/qgit/">QGit</a> or <a href="http://gitx.frim.nl/">GitX</a> on Windows, Ubuntu and Mac OS X, respectively.
                </div>
                <div>
                    <strong>Note #2:</strong> though OpenCOR is currently being developed using Qt 4.7.2 and Qt Creator 2.1.0, it happens that it can also be built using Qt 4.6. For this reason, our <a href="../../CMakeLists.txt">CMake script</a> requires Qt 4.6 or above to build OpenCOR, but this requirement will be revised as soon as Qt 4.6 is shown to break the build.
                </div>
            </li>
            <li><a href="http://nsis.sourceforge.net/">NSIS</a> (Windows only): a program for creating Windows installers.</li>
        </ul>

        <p>
            Please note that the above pre-requirements are meant for someone who wants to develop, build, test and package OpenCOR in the exact same way as it is done by the <a href="../user/authors.html">OpenCOR team</a>. However, when it comes to Qt and Qt Creator, older versions may also work (e.g. on Ubuntu, you might just want to install the <a href="http://packages.ubuntu.com/maverick/qtcreator">qtcreator</a> package).
        </p>

        <h2>
            Develop
        </h2>

        <p>
            Except for the <a href="../user/authors.html">authors</a>, OpenCOR is not currently opened for development. This will change as soon as OpenCOR gets officially released.
        </p>

        <h2>
            <a name="buildAndTest" class="sectionAnchor">Build and Test</a>
        </h2>

        <p>
            OpenCOR can be built in two different ways:
        </p>

        <ul>
            <li>
                <strong>Command line:</strong> various batch and VBScript files (<code>.bat</code> and <code>.vbs</code> files) on Windows and shell scripts on Ubuntu/Mac OS X are available: (Note that these command line tools require access to CMake, MinGW/g++/Xcode (for Windows, Ubuntu and Mac OS X, respectively) and Qt from the command line. So, make sure that this is the case by updating your <code>PATH</code> environment variable, if necessary.)
                <ul>
                    <li><code><a href="../../cleanproj">cleanproj</a>[<a href="../../cleanproj.bat">.bat</a>]</code>: cleans the OpenCOR environment;</li>
                    <li><code><a href="../../cleanprojall">cleanprojall</a>[<a href="../../cleanprojall.bat">.bat</a>]</code>: cleans all of the OpenCOR environment (i.e. including <a href="thirdPartyLibraries.html">third-party libraries</a>);</li>
                    <li>
                        <code><a href="../../makeproj">makeproj</a>[<a href="../../makeproj.bat">.bat</a>]</code>: compiles and links everything that is required to get a release version of OpenCOR; and
                        <div>
                            <strong>Note:</strong> <code>makeproj[.bat]</code> does, by default, compile OpenCOR in parallel. You can, however, specify the number of processors to be used, thus making it possible to compile OpenCOR sequentially, if needed:
                            <pre>$ ./makeproj 1</pre>
                        </div>
                    </li>
                    <li>
                        <code><a href="../../runproj">runproj</a>[<a href="../../runproj.bat">.bat</a>|<a href="../../runproj.vbs">.vbs</a>]</code>: runs OpenCOR.
                        <div>
                            <strong>Note:</strong> on Windows, if you were to run OpenCOR from a console window by just entering <code>runproj</code>, then the <code>runproj.bat</code> file would be executed (rather than the <code>runproj.vbs</code> file), offering you the opportunity to use OpenCOR as a console application. However, if you were to run OpenCOR by double clicking the <code>runproj.bat</code> file from within Windows Explorer, then a console window will quickly appear and disappear. To avoid this, you should double click on the <code>runproj.vbs</code> file.
                        </div>
                    </li>
                </ul>
            </li>
            <li>
                <strong>Using Qt Creator:</strong>
                <ul>
                    <li>Start Qt Creator;</li>
                    <li>Open <a href="../../CMakeLists.txt"><code>[OpenCOR]/CMakeLists.txt</code></a> (by selecting the <code>File|Open File or Project...</code> menu or by pressing <code>Ctrl+O</code>);</li>
                    <li>Specify <a href="../../build"><code>[OpenCOR]/build</code></a> as the build directory;</li>
                    <li>Select <code>MinGW</code> as the generator (Windows only), if necessary;</li>
                    <li>Click on the <code>Run CMake</code> button;</li>
                    <li>Click on the <code>Finish</code> button;</li>
                    <li>Select <code>OpenCOR</code> as the run target (by selecting the <code>Build|Open Build/Run Target Seclector...</code> menu or by pressing <code>Ctrl+T</code>), if necessary; and</li>
                    <li>
                        Build and test OpenCOR (by selecting the <code>Build|Run</code> menu or by pressing <code>Ctrl+R</code>).
                        <div>
                            <strong>Note #1:</strong> because of our use of CMake, debugging with Qt Creator requires an extra build step which can be set up by selecting the <code>Projects</code> view and by clicking on the <code>Add Build Step</code> drop-down button and clicking on the <code>Custom Process Step</code> menu item. From there, tick the <code>Enable custom process step</code> check box, and set the <code>Command</code> field to <code>cmake</code>, the <code>Working directory</code> field to <code>${BUILDDIR}/build</code> and the <code>Command arguments</code> field to <code>-DCMAKE_BUILD_TYPE=Debug ..</code>. Finally, make sure that this new build step comes before the default <code>Make</code> build step. 
                        </div>
                        <div>
                            <strong>Note #2:</strong> by default, Qt Creator will compile OpenCOR sequentially, but this can be changed by selecting the <code>Projects</code> view and by clicking on the <code>Details</code> drop-down button of the default <code>Make</code> build step under the <code>Build Steps</code> header. From there, just set the <code>Additional arguments</code> field to <code>-j [n]</code> where <code>n</code> is the number of jobs to be run simultaneously (if no <code>n</code> value is provided, then Qt Creator will try to run as many jobs as possible simultaneously).
                        </div>
                        <div>
                            <strong>Note #3:</strong> should new translations be required (e.g. as a result of adding a new action), then <code>[OpenCOR]/CMakeLists.txt</code> must be recompiled for the translation file(s) (<code>[OpenCOR]/i18n/OpenCOR_xx.ts</code>) to be updated and then for the translations to be added using Qt Linguist (it comes with Qt Creator).
                        </div>
                    </li>
                </ul>
            </li>
        </ul>

        <h2>
            Package
        </h2>

        <p>
            The packaging of OpenCOR can only be done from the command line, using <a href="../../packageproj.bat"><code>packageproj.bat</code></a> on Windows and <a href="../../packageproj"><code>packageproj</code></a> on Ubuntu / Mac OS X. Note that though the Ubuntu package is originally meant for Ubuntu 10.10 (Maverick Meerkat; both 32-bit and 64-bit), it should also work with other versions of Ubuntu, as well as other Linux distributions though additional libraries may be required in the latter case.
        </p>

        <div class="copyright">
            Copyright ©2011
        </div>
    </body>
</html>
